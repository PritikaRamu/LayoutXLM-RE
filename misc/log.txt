
 id
['zh_train_125_1', 'zh_train_85_0', 'zh_train_122_0', 'zh_train_12_1']

 input_ids
torch.Size([4, 512])
tensor(244792)
text is: InternetBankingService个人网上银行服务 ☑Yes是 □No否 *Doyouwanttouseinternetbankingservice?您需要申请网上银行服务? MobileBankingService个人手机银行(境外版)服务 *DoyouwanttousetheBOCMobileBankingservice?您需要申请个人手机银行(境外版)服务吗? ☑Yes是 □No否 MonthlyBankStatement月度对账单 Wewillpostyourmonthlybankstatementtoyourcorrespondenceaddressunlessthereisnotransaction.Ifyoudonotwish toreceivebankstatement,pleasetickthisboxtocomfirmyourchoice.如果您的账户当月有交易,我们将会给您寄送银行 账户对账单。如果您不想接收银行对账单,请您在下方勾选不需要该项服务。 □Idonotwishtoreceivebankstatementbypost.我不希望接收银行寄送的对账单 *1staccountholder第一账户持有人 Identitydetails身份资料 □ Mrs □' Miss Mr 先生 □ Ms Other(pleasespecify) 夫人 小姐 □ 其它(请具体注明) 女士 *SurnameinChinese中文姓 *OthernamesinChinese中文名 欧 超航” *SurnameinEnglish英文姓 Smith *MiddlenameinEnglish中间英文名 *OthernamesinEnglish英文名 Bob 2 Harry ☑ ☑ ☑ □ *Title:称谓:<pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad>

 bbox
torch.Size([4, 512, 4])
tensor(945) tensor(0)

 labels
torch.Size([4, 512])

 hd_image
torch.Size([4, 3, 1024, 1024])

 entities
4 dict_keys(['start', 'end', 'label'])

 relations
4 dict_keys(['head', 'tail', 'start_index', 'end_index'])

 attention_mask
torch.Size([4, 512])

 image
torch.Size([4, 3, 224, 224])
{'head': [2, 3, 3, 7, 8, 8, 11, 14, 16, 17, 18, 20, 22, 22, 25, 27], 'tail': [1, 4, 5, 6, 9, 10, 12, 15, 13, 29, 19, 21, 23, 24, 26, 28], 'start_index': [7, 29, 29, 43, 51, 51, 61, 77, 73, 87, 93, 103, 108, 108, 152, 160], 'end_index': [29, 41, 43, 51, 58, 61, 73, 84, 87, 168, 103, 108, 131, 149, 160, 167]}
{'start': [0, 7, 26, 29, 32, 41, 43, 44, 51, 54, 58, 61, 69, 73, 77, 80, 84, 87, 93, 100, 103, 106, 108, 111, 131, 152, 157, 160, 166, 167], 'end': [7, 26, 29, 32, 41, 43, 44, 51, 54, 58, 61, 66, 73, 77, 80, 84, 87, 93, 98, 103, 106, 108, 111, 131, 149, 157, 160, 166, 167, 168], 'label': [0, 2, 1, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2]}
[{'head': [2, 3, 3, 7, 8, 8, 11, 14, 16, 17, 18, 20, 22, 22, 25, 27], 'tail': [1, 4, 5, 6, 9, 10, 12, 15, 13, 29, 19, 21, 23, 24, 26, 28], 'start_index': [7, 29, 29, 43, 51, 51, 61, 77, 73, 87, 93, 103, 108, 108, 152, 160], 'end_index': [29, 41, 43, 51, 58, 61, 73, 84, 87, 168, 103, 108, 131, 149, 160, 167]}, {'head': [3, 6, 7, 9, 12, 14, 16, 18, 20, 20, 20, 20, 26, 26, 29, 32, 32, 36, 36, 36, 41, 41, 44, 44, 48], 'tail': [4, 5, 8, 10, 13, 15, 17, 19, 23, 22, 24, 21, 27, 28, 30, 33, 34, 39, 38, 37, 42, 43, 46, 45, 47], 'start_index': [13, 21, 29, 48, 73, 79, 85, 93, 104, 104, 104, 104, 129, 129, 143, 160, 160, 183, 183, 183, 207, 207, 229, 229, 245], 'end_index': [21, 29, 48, 56, 79, 85, 93, 104, 121, 116, 126, 112, 138, 143, 157, 168, 172, 199, 195, 191, 220, 229, 241, 237, 259]}, {'head': [3, 5, 7, 9, 11, 13, 16, 18, 20, 22, 24, 26, 28, 30, 32, 36, 40, 43, 45, 47, 48, 51, 53, 55, 56, 57, 62, 64, 67, 69, 71, 73, 75, 77, 79, 80, 83, 84], 'tail': [4, 6, 8, 10, 12, 14, 17, 19, 21, 23, 25, 27, 29, 31, 33, 38, 42, 44, 46, 50, 49, 52, 54, 58, 59, 61, 63, 65, 68, 70, 72, 74, 76, 78, 34, 41, 37, 39], 'start_index': [15, 24, 29, 40, 45, 51, 58, 68, 77, 87, 93, 100, 111, 120, 130, 146, 159, 169, 176, 185, 191, 209, 217, 227, 230, 233, 252, 258, 267, 274, 281, 289, 295, 322, 141, 164, 149, 157], 'end_index': [24, 29, 40, 45, 51, 56, 68, 75, 87, 93, 100, 107, 120, 130, 141, 157, 169, 176, 185, 209, 203, 217, 227, 241, 243, 248, 258, 265, 272, 279, 286, 295, 322, 336, 338, 340, 348, 351]}, {'head': [3, 5, 5, 6, 7, 8, 9, 10, 11, 12, 23, 24, 26, 27, 27, 27, 28, 29, 35, 39, 40, 43, 44, 45], 'tail': [14, 18, 19, 20, 21, 15, 16, 22, 17, 13, 33, 31, 36, 4, 0, 2, 32, 34, 41, 42, 46, 37, 1, 38], 'start_index': [39, 67, 67, 70, 72, 75, 78, 81, 85, 88, 139, 142, 150, 42, 0, 20, 156, 159, 177, 195, 198, 184, 16, 189], 'end_index': [99, 120, 123, 125, 132, 104, 116, 139, 118, 94, 174, 167, 184, 156, 156, 156, 171, 177, 207, 213, 225, 216, 220, 223]}]
[{'start': [0, 7, 26, 29, 32, 41, 43, 44, 51, 54, 58, 61, 69, 73, 77, 80, 84, 87, 93, 100, 103, 106, 108, 111, 131, 152, 157, 160, 166, 167], 'end': [7, 26, 29, 32, 41, 43, 44, 51, 54, 58, 61, 66, 73, 77, 80, 84, 87, 93, 98, 103, 106, 108, 111, 131, 149, 157, 160, 166, 167, 168], 'label': [0, 2, 1, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2]}, {'start': [0, 6, 10, 13, 17, 21, 24, 29, 33, 48, 51, 69, 73, 77, 79, 83, 85, 88, 93, 99, 104, 108, 112, 116, 121, 126, 129, 133, 138, 143, 150, 157, 160, 164, 168, 180, 183, 187, 191, 195, 203, 207, 210, 220, 229, 233, 237, 245, 249], 'end': [6, 10, 13, 17, 21, 24, 29, 33, 48, 51, 56, 73, 77, 79, 83, 85, 88, 93, 99, 104, 108, 112, 116, 121, 126, 129, 133, 138, 143, 150, 157, 160, 164, 168, 172, 183, 187, 191, 195, 199, 207, 210, 220, 229, 233, 237, 241, 249, 259], 'label': [0, 0, 1, 1, 2, 2, 1, 1, 2, 1, 2, 0, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 2, 2, 2, 1, 1, 2, 2, 1, 2, 1, 1, 2, 2, 1, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 2, 1]}, {'start': [0, 4, 11, 15, 18, 24, 27, 29, 34, 40, 43, 45, 48, 51, 54, 56, 58, 61, 68, 73, 77, 80, 87, 90, 93, 96, 100, 104, 111, 115, 120, 124, 130, 133, 141, 144, 146, 149, 151, 157, 159, 164, 166, 169, 172, 176, 179, 185, 191, 194, 203, 209, 213, 217, 221, 227, 230, 233, 237, 241, 243, 245, 252, 255, 258, 262, 265, 267, 270, 274, 277, 281, 284, 289, 293, 295, 298, 322, 329, 336, 338, 340, 342, 345, 348], 'end': [4, 11, 15, 18, 24, 27, 29, 34, 40, 43, 45, 48, 51, 54, 56, 58, 61, 68, 73, 75, 80, 87, 90, 93, 96, 100, 104, 107, 115, 120, 124, 130, 133, 141, 144, 146, 149, 151, 157, 159, 162, 166, 169, 172, 176, 179, 185, 189, 194, 203, 209, 213, 217, 221, 227, 230, 233, 237, 241, 243, 245, 248, 255, 258, 262, 265, 267, 270, 272, 277, 279, 284, 286, 293, 295, 298, 322, 329, 336, 338, 340, 342, 345, 348, 351], 'label': [0, 0, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 1, 2, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 1, 2, 1, 1, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1]}, {'start': [0, 16, 20, 39, 42, 67, 70, 72, 75, 78, 81, 85, 88, 90, 94, 99, 110, 116, 118, 120, 123, 125, 132, 139, 142, 145, 150, 153, 156, 159, 162, 166, 167, 171, 174, 177, 182, 184, 189, 195, 198, 203, 209, 213, 216, 220, 223], 'end': [16, 20, 39, 42, 60, 70, 72, 75, 78, 81, 85, 88, 90, 94, 99, 104, 116, 118, 120, 123, 125, 132, 139, 142, 145, 150, 153, 156, 159, 162, 166, 167, 171, 174, 177, 182, 184, 189, 195, 198, 203, 207, 213, 216, 220, 223, 225], 'label': [2, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 0, 1, 1, 1, 1, 0, 2, 2, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 1, 1, 1, 2]}]
total steps: 470, total examples:, 1880, warmup steps: 70.5
Epoch: 0
Loss after 0 steps: 0.552839994430542
Loss after 10 steps: 0.46570928259329364
Loss after 20 steps: 0.3633556060847782
Loss after 30 steps: 0.31682781899167645
Loss after 40 steps: 0.2967954610542553
epoch done, avg_loss: 0.29882884296503937, nb_examples: 187
Epoch: 1
Loss after 50 steps: 0.21836098656058311
Loss after 60 steps: 0.21435082597391947
Loss after 70 steps: 0.22585401063164076
Loss after 80 steps: 0.23001958429813385
Loss after 90 steps: 0.22556087950413878
epoch done, avg_loss: 0.2234904488777732, nb_examples: 187
Epoch: 2
Loss after 100 steps: 0.17212483286857605
Loss after 110 steps: 0.214966760838733
Loss after 120 steps: 0.22608490564205028
Loss after 130 steps: 0.21822239378014127
Loss after 140 steps: 0.21998595649545843
epoch done, avg_loss: 0.21998595649545843, nb_examples: 187
Epoch: 3
Loss after 150 steps: 0.22517610639333724
Loss after 160 steps: 0.22070317193865777
Loss after 170 steps: 0.21144503553708394
Loss after 180 steps: 0.21033654790371656
epoch done, avg_loss: 0.20907624057907473, nb_examples: 187
Epoch: 4
Loss after 190 steps: 0.1939083139101664
Loss after 200 steps: 0.19572143657849386
Loss after 210 steps: 0.20207922516957574
Loss after 220 steps: 0.198983256789771
Loss after 230 steps: 0.20162659484979717
epoch done, avg_loss: 0.2011866048376828, nb_examples: 187
Epoch: 5
Loss after 240 steps: 0.17560724169015884
Loss after 250 steps: 0.17707393504679203
Loss after 260 steps: 0.18451054623493782
Loss after 270 steps: 0.1853206865489483
Loss after 280 steps: 0.18766277542580728
epoch done, avg_loss: 0.18703073805028742, nb_examples: 187
Epoch: 6
Loss after 290 steps: 0.16467875076664817
Loss after 300 steps: 0.18439081389653056
Loss after 310 steps: 0.17881982182634287
Loss after 320 steps: 0.17643813082040885
epoch done, avg_loss: 0.1770061257688757, nb_examples: 187
Epoch: 7
Loss after 330 steps: 0.22036170959472656
Loss after 340 steps: 0.1926433313637972
Loss after 350 steps: 0.1809870224784721
Loss after 360 steps: 0.16532042622566223
Loss after 370 steps: 0.1617894648086457
epoch done, avg_loss: 0.16342384101235294, nb_examples: 187
Epoch: 8
Loss after 380 steps: 0.14099342226982117
Loss after 390 steps: 0.16220668951670328
Loss after 400 steps: 0.1563349688053131
Loss after 410 steps: 0.15055310342993056
Loss after 420 steps: 0.14622515108850268
epoch done, avg_loss: 0.14638853248427897, nb_examples: 187
Epoch: 9
Loss after 430 steps: 0.14254090655595064
Loss after 440 steps: 0.1351046793990665
Loss after 450 steps: 0.13402743743998663
Loss after 460 steps: 0.1318116893893794
epoch done, avg_loss: 0.13288086302140178, nb_examples: 187
RE Evaluation in *** BOUNDARIES *** mode
processed 65 sentences with 1559 relations; found: 445 relations; correct: 166.
	ALL	 TP: 166;	FP: 279;	FN: 1393
		(m avg): precision: 0.37;	recall: 0.11;	f1: 0.17 (micro)
		(M avg): precision: 0.37;	recall: 0.11;	f1: 0.17 (Macro)

	1: 	TP: 166;	FP: 279;	FN: 1393;	precision: 0.37;	recall: 0.11;	f1: 0.17;	445
{'eval_precision': 0.37303370786516854, 'eval_recall': 0.10647851186658114, 'eval_f1': 0.1656686626746507, 'eval_loss': 0.11914727091789246}
[{'head_id': 6, 'head': (40, 45), 'head_type': 1, 'tail_id': 10, 'tail': (62, 66), 'tail_type': 2, 'type': 1}, {'head_id': 9, 'head': (59, 62), 'head_type': 1, 'tail_id': 10, 'tail': (62, 66), 'tail_type': 2, 'type': 1}, {'head_id': 4, 'head': (33, 37), 'head_type': 1, 'tail_id': 10, 'tail': (62, 66), 'tail_type': 2, 'type': 1}, {'head_id': 19, 'head': (162, 166), 'head_type': 1, 'tail_id': 12, 'tail': (72, 83), 'tail_type': 2, 'type': 1}, {'head_id': 3, 'head': (30, 33), 'head_type': 1, 'tail_id': 7, 'tail': (45, 53), 'tail_type': 2, 'type': 1}, {'head_id': 3, 'head': (30, 33), 'head_type': 1, 'tail_id': 2, 'tail': (26, 30), 'tail_type': 2, 'type': 1}, {'head_id': 6, 'head': (40, 45), 'head_type': 1, 'tail_id': 7, 'tail': (45, 53), 'tail_type': 2, 'type': 1}, {'head_id': 13, 'head': (83, 87), 'head_type': 1, 'tail_id': 15, 'tail': (112, 141), 'tail_type': 2, 'type': 1}, {'head_id': 5, 'head': (37, 40), 'head_type': 1, 'tail_id': 10, 'tail': (62, 66), 'tail_type': 2, 'type': 1}, {'head_id': 8, 'head': (53, 56), 'head_type': 1, 'tail_id': 10, 'tail': (62, 66), 'tail_type': 2, 'type': 1}, {'head_id': 4, 'head': (33, 37), 'head_type': 1, 'tail_id': 7, 'tail': (45, 53), 'tail_type': 2, 'type': 1}]
{'start': [14, 19, 26, 30, 33, 37, 40, 45, 53, 59, 62, 66, 72, 83, 87, 112, 141, 158, 160, 162, 166, 170, 210, 211, 225, 226, 245, 255, 256, 257, 263, 269, 270, 271, 278, 279, 285, 286, 287, 302, 303, 304, 305, 306, 322, 324, 327, 329, 332, 354, 355, 356, 364, 436, 439, 447, 450, 456, 457, 458], 'end': [19, 26, 30, 33, 37, 40, 45, 53, 56, 62, 66, 72, 83, 87, 112, 141, 158, 160, 162, 166, 170, 173, 211, 225, 226, 245, 255, 256, 257, 263, 269, 270, 271, 278, 279, 285, 286, 287, 302, 303, 304, 305, 306, 322, 324, 327, 329, 332, 354, 355, 356, 364, 372, 439, 447, 450, 456, 457, 458, 459], 'label': [0, 0, 2, 1, 1, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2, 1, 2, 2, 2, 1, 2, 1, 1, 2, 2, 1, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2]}
